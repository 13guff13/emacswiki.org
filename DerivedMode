Instead of writing a new mode from scratch, you should derive your new mode from an existing mode.  Deriving a new mode from fundamental mode (which does basically nothing) is better than writing a new mode from scratch.  (Unless you know what you are doing, of course.)

Here's an example of how to translate a very simple GenericMode code sample into a DerivedMode code sample.  This would be the way to go if you think that GenericMode is too limiting for your needs.

Old GenericMode code:

 (define-generic-mode `kk-mode
   ()
   ()
   '(("\\(--.*\\)" 1 'font-lock-comment-face))
   ()
   (list (lambda () (set (make-local-variable 'comment-start) "--")))
   "Major mode to edit KK files.")

New DerivedMode code:

 (defvar kk-mode-font-lock-keywords
   '(("\\(--.*\\)" 1 'font-lock-comment-face)))
  
 (define-derived-mode kk-mode fundamental-mode "KK"
   "Major mode to edit KK files."
   (set (make-local-variable 'font-lock-keywords)
        '(kk-mode-font-lock-keywords))
   (set (make-local-variable 'comment-start) "--"))

If you are looking for an example for using a DerivedMode in released
software, and you like to cook (with food as well as with code), see
RicetteMode.

Another example of a simple mode defined by derivation is this
simple procmail mode
[http://list-archive.xemacs.org/xemacs-design/200206/msg00103.html].
Note that there is another ProcmailMode available via tiny tools.

  (define-derived-mode procmail-mode fundamental-mode "Procmail"
    "Major mode for editing procmail recipes."

    (setq comment-start "#")
    (setq comment-start-skip "#\\W*")

    ;;register keywords
    (setq procmail-font-lock-keywords
          (list '("#.*"
                  . font-lock-comment-face)
                '("^[\t ]*:.*"
                  . font-lock-type-face)
                '("[A-Za-z_]+=.*"
                  . font-lock-keyword-face)
                '("^[\t ]*\\*.*"
                  . font-lock-doc-string-face)
                '("\$[A-Za-z0-9_]+"
                  . font-lock-function-name-face)))

    (font-lock-mode))

  (add-to-list 'auto-mode-alist '(".procmailrc\\'" . procmail-mode))

Another example is SimpleWikiMode.

----
CategoryCode
