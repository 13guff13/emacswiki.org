GNU Emacs development is switching from CVS to [http://bazaar-vcs.org Bzr].  This page is about making that switchover go smoothly.

[:Where]
== Latest Test Repository (2009-11-12) ==

Start browsing here: http://bzr.savannah.gnu.org/lh/emacs/ . To get a local copy of the repository, this is probably fastest:

<pre>
$ scp -r yourusername@bzr.savannah.gnu.org:/srv/bzr/emacs emacs-bzr-repository
</pre>

That gets you the whole repository, but with empty dirs for the working trees.  You can "check out" (i.e., fill in) a working tree like this:

<pre>
$ cd emacs-bzr-repository
$ ls
Boehm-GC/	 emacs-unicode-2/   ILYA/		    ttn-vms-21-2-stash/
Boehm-versions/  FLYSPELL/	    lexbind/		    ttn-vms-21-3-stash/
branch-5_8/	 font-backend/	    master-UNNAMED-BRANCH/  unicode-xft/
custom_themes/	 fx-branch/	    multi-tty/		    URL/
DAVELOVE/	 gerd_big/	    NewVC-fileset/	    VENDOR/
EMACS_21_1_RC/	 gerd_dbe/	    patches_21_0/	    XFT_JHD_BRANCH/
EMACS_22_BASE/	 gerd_defvaralias/  rmail-mbox-branch/
EMACS_23_1_RC/	 glibc-2_0_x/	    test2/
emacs-bidi/	 gnus-5_10-branch/  trunk/
$ cd trunk
$ ls
$ ls -Ca
./  ../  .bzr/
$ bzr checkout
$ ls -Ca
.		 config.guess	 .gitignore	 lwlib		 oldXMenu
..		 config.sub	 info		 m4		 README
admin		 configure	 INSTALL	 make-dist	 src
.arch-inventory  configure.in	 INSTALL.CVS	 Makefile.in	 test
autogen.sh	 COPYING	 install-sh	 mkinstalldirs	 update-subdirs
BUGS		 .cvsignore	 kff-log-n0.out  move-if-change  vpath.sed
.bzr		 .dir-locals.el  leim		 msdos
ChangeLog	 doc		 lib-src	 nextstep
config.bat	 etc		 lisp		 nt
$ bzr log -n0
  # See a bunch of changes fly by... hopefully some of them look familiar!
$ 
</pre>

== Switchover Checklist ==

* Test the conversion.

* Rename and rewrite INSTALL.CVS.  (Just rename to "INSTALL.DEV", so it's not VC-specific anymore?)

* Make sure Loggerhead or some other repository web browsing software is installed on Savannah.  (Seems to be [http://savannah.gnu.org/support/index.php?106612#comment16 done] now, but may still need some [https://savannah.gnu.org/support/index.php?106612#comment17 debugging].

* Test that anon access works.

* Test that SSH dev access works.

* Make sure commit emails work.
** Fix the email diff generator, if necessary; see https://savannah.gnu.org/support/?106531

* Update http://www.gnu.org/software/emacs/.

* Update http://savannah.gnu.org/projects/emacs.

=== Nice-to-Haves ===

These things can be done after the switchover, we just shouldn't forget them:

* Prepare a switchover document for regular Emacs developers (base it on [http://bazaar-vcs.org/Scenarios/RepeatedContributions this scenario]), so they don't all have to read the entire [http://doc.bazaar-vcs.org/bzr.dev/en/user-guide/index.html Bzr Users Guide] to continue working on Emacs.
** See [[BzrForEmacsDevs#RegularContributors]]

* Prepare one-off contribution document (base it on [http://bazaar-vcs.org/Scenarios/OneOffContribution this scenario])
** See [[BzrForEmacsDevs#PatchContributors]]

* Document how to do a release from bzr (or adjust our existing release procedure documentation... where is it, anyway?) Possibly ...emacs/admin/FOR-RELEASE
** See [[BzrForEmacsDevs#Releases]]

[:References]
== References ==

* [http://savannah.gnu.org/support/index.php?107170 Savannah ticket #107170] This is the big one: make the CVS repository read-only, so we can do our final conversion and start using Bazaar.

* [http://savannah.gnu.org/support/index.php?106612 Savannah ticket #106612] about the Emacs Bzr switchover in general.

* [https://savannah.gnu.org/support/index.php?107143 Savannah ticket #107143] and [https://savannah.gnu.org/support/?107077 #107077] about getting bzr+ssh access to work on savannah.gnu.org.

* [https://savannah.gnu.org/support/index.php?107142 Savannah ticket #107142] Browsing Bazaar repositories doesn't work

* [https://savannah.gnu.org/support/index.php?106951 Savannah ticket #106951] about upgrading Bazaar to 1.17 on Savannah.

* [https://savannah.gnu.org/support/index.php?106531 Savannah ticket #106531] about bzr commit emails omitting large diffs.

* [https://savannah.gnu.org/support/index.php?107118 Savannah ticket #107118] about fixing the bzr access instructions on Savannah project pages.

* [https://bugs.edge.launchpad.net/bzr/+bugs?field.searchtext=&orderby=-importance&assignee_option=any&field.assignee=&field.bug_reporter=&field.bug_supervisor=&field.bug_commenter=&field.subscriber=&field.omit_dupes.used=&field.omit_dupes=on&field.has_patch.used=&field.has_cve.used=&field.tag=emacs-adoption&field.tags_combinator=ANY&search=Search List of Bazaar bugs tagged with "emacs-adoption"].
