== Introduction ==

Rudel (German for "pack" as in "pack of wolves") is a [CollaborativeEditing collaborative editing] environment
for GNU Emacs. Its purpose is to share buffers with other users in
order to edit the contents of those buffers collaboratively. It
supports multiple backends to enable communication with other
collaborative editors using different protocols (most notably
[http://gobby.0x539.de/trac/ Gobby] and possibly
[http://www.codingmonkeys.de/subethaedit/ SubEthaEdit]).

Rudel mostly works in the background to change the behavior of the set
of Emacs buffers for which it has been activated. These do not even
have to have a certain [MinorMode minor mode] enabled.

The user interface of Rudel consists of a set of key bindings, a menu
entry and some visual status indicators, which are added to the text
and mode line of buffers for which Rudel has been activated. This user
interface is implemented as a global minor mode.

The image below shows a collaborative editing session with one Gobby
and two Rudel clients (only one of these is visible).

http://rudel.sourceforge.net/images/screenshots/emacs-with-gobby.png

== Download ==

Archives of released versions can be downloaded from the
[https://sourceforge.net/project/platformdownload.php?group_id=249139
download area] of the [http://sourceforge.net/projects/rudel
Sourceforge project page].

Development versions are available via

* the [[Bazaar]] repository on Sourceforge:
  {{{
  bzr branch bzr://rudel.bzr.sourceforge.net/bzrroot/rudel/trunk rudel
  }}}

* the [[SubVersion]] repository on Sourceforge:
  {{{
  svn co https://rudel.svn.sourceforge.net/svnroot/rudel/trunk rudel
  }}}

* the (experimental, but hopefully properly synchronized) [[Git]]
  [http://github.com/scymtym/rudel repository] at 
  [http://www.github.com GitHub]:
  {{{
  git clone git://github.com/scymtym/rudel.git
  }}}


== Installation ==

=== Requirements ===

To use Rudel, the following software is required:

* *GNU Emacs 22 or above*
   Rudel should work with recent versions of GNU Emacs starting from
   version 22. Older versions of GNU Emacs or XEmacs may or may not work
   but are not actively tested.

* *Collection of Emacs Development Environment Tools*
  [[CEDET]] contains the object system [[EIEIO]], which is used in
  Rudel's object-oriented implementation. [[CEDET]] can be obtained
  from [http://cedet.sourceforge.net/]. It is necessary to use at least
  version 1.0pre6 of [[CEDET]] since a serious problem in the object
  system [[EIEIO]] was fixed in that release.

[new]
If you are using Emacs from trunk (as of October 2009), CEDET is
included and doesn't need to be installed separately. Using Rudel from
trunk will be much easier to install.

On earlier versions of Emacs, CEDET can be difficult to install, (and
unfortunately is not in ELPA due to the maintainer's
uncooperativeness), so here's some help:

<pre>
(defun load-rudel ()
  (interactive)
  ;; Do these in a shell in ~/src:
  ;; cvs -d:pserver:anonymous@cedet.cvs.sourceforge.net:/cvsroot/cedet login
  ;; cvs -z3 -d:pserver:anonymous@cedet.cvs.sourceforge.net:/cvsroot/cedet co -P cedet
  ;; cd cedet && make && cd ..
  ;; svn co https://rudel.svn.sourceforge.net/svnroot/rudel/rudel/trunk rudel
  (add-to-list 'load-path "~/src/cedet/eieio")
  (add-to-list 'load-path "~/src/cedet/common")
  (add-to-list 'load-path "~/src/rudel/")
  (add-to-list 'load-path "~/src/rudel/jupiter")
  (add-to-list 'load-path "~/src/rudel/obby")
  (require 'rudel-mode)
  (require 'rudel-obby)
  (global-rudel-minor-mode))
</pre>

Autoloads and byte-compilation don't work for me due to a strange cedet
dependency problem, but this should get you in a working state.
[new]

* *!GnuTLS (optional)*
  Connections to Gobby servers require the gnutls-cli program.

=== Installing ===

To install Rudel, download a released version or the current
development version from [http://sourceforge.net/projects/rudel/] and
place the code in any directory you like.

To make Rudel available for use, perform these steps:

# If there is no file ##rudel-loaddefs.el## in your version of Rudel, open and evaluate ##rudel-compile.el## (see below) to generate the file. If ##rudel-loaddefs.el## is already present, no action is required.

# Add the following to your personal Emacs configuration:

  (load-file "/PATH/TO/RUDEL/rudel-loaddefs.el")

This will set Rudel up to be loaded on demand (see [[AutoLoad]])
when one of the commands `rudel-join-session', `rudel-host-session' or
`global-rudel-minor-mode' is invoked. The auto loading information in
##rudel-loaddefs.el## is distributed with older versions of Rudel, but has
to be generated using ##rudel-compile.el## in more recent versions.

=== Compiling ===

In order to achieve better performance, Emacs can byte-compile the
Rudel code. This can be done by opening <tt>rudel-compile.el</tt> in
Emacs and invoking M-x eval-buffer. In recent versions of Rudel, this also
generates auto loading information (see above).

== Development ==

If you would like to contribute to Rudel by submitting patches or
reporting bugs, use the Questions and Feedback section below,
[http://sourceforge.net/mail/?group_id=249139 the mailing list] or
[http://sourceforge.net/tracker/?group_id=249139 the issue tracker].
You can also try #rudel on irc.freenode.net.

When reporting bugs, please make sure to include the Emacs version, the CEDET version,
the Rudel version and a descriptions of the steps that lead to the
bug.

For long term contributions, becoming a member of the Sourceforge
project is more appropriate.

== Questions and Feedback ==

/Paste questions and feedback here./

/Parts of the contents of this section have been moved to /[[RudelDiscussionArchive]].

[new]
UPDATE: Okay... Just tried to both "host" and then, when that failed, to "join" a session and neither one now works. I haven't updated either emacs or rudel, but some security software related to FireFox did get updated this morning. That's the only thing that changed.

------------

I'm getting serious errors on joining obby session. First:

* Warning (rudel): Could not load backend `telepathy': Wrong type argument: arrayp, nil

Then I get:

*  Debugger entered--Lisp error: (error "Primary-only method rudel-ask-connect-info called on something not an object")
  signal(error ("Primary-only method rudel-ask-connect-info called on something not an object"))
  error("Primary-only method %s called on something not an object" rudel-ask-connect-info)
  eieio-generic-call-primary-only(rudel-ask-connect-info (rudel-telepathy-backend (:name "asked" :protocol-backend (obby . [object rudel-obby-backend "obby" (0 3) (join host change-color track-subscriptions encrypt)]) :transport-backend (telepathy . rudel-telepathy-backend))))
  rudel-ask-connect-info(rudel-telepathy-backend (:name "asked" :protocol-backend (obby . [object rudel-obby-backend "obby" (0 3) (join host change-color track-subscriptions encrypt)]) :transport-backend (telepathy . rudel-telepathy-backend)))
  rudel-ask-protocol-backend([object rudel-ask-protocol-backend "ask-protocol" (0 2) (discover) fallback])
  apply(rudel-ask-protocol-backend [object rudel-ask-protocol-backend "ask-protocol" (0 2) (discover) fallback])
  eieio-generic-call-primary-only(rudel-discover ([object rudel-ask-protocol-backend "ask-protocol" (0 2) (discover) fallback]))
  rudel-discover([object rudel-ask-protocol-backend "ask-protocol" (0 2) (discover) fallback])
  rudel-session-initiation-discover(ask-protocol)
  (let* ((sessions (rudel-session-initiation-discover session-initiation-backend)) (maybe-info (if (= (length sessions) 1) (car sessions) (rudel-read-session sessions "Choose Session: " (quote object))))) (if (rudel-backend-cons-p maybe-info) (setq session-initiation-backend (car maybe-info)) (setq info maybe-info)))
  (while (not info) (message "Discovering Sessions ...") (let* ((sessions (rudel-session-initiation-discover session-initiation-backend)) (maybe-info (if (= (length sessions) 1) (car sessions) (rudel-read-session sessions "Choose Session: " (quote object))))) (if (rudel-backend-cons-p maybe-info) (setq session-initiation-backend (car maybe-info)) (setq info maybe-info))))
  (let ((info) (session-initiation-backend)) (while (not info) (message "Discovering Sessions ...") (let* ((sessions (rudel-session-initiation-discover session-initiation-backend)) (maybe-info (if (= (length sessions) 1) (car sessions) (rudel-read-session sessions "Choose Session: " (quote object))))) (if (rudel-backend-cons-p maybe-info) (setq session-initiation-backend (car maybe-info)) (setq info maybe-info)))) info)
  (list (let ((info) (session-initiation-backend)) (while (not info) (message "Discovering Sessions ...") (let* ((sessions (rudel-session-initiation-discover session-initiation-backend)) (maybe-info (if (= ... 1) (car sessions) (rudel-read-session sessions "Choose Session: " ...)))) (if (rudel-backend-cons-p maybe-info) (setq session-initiation-backend (car maybe-info)) (setq info maybe-info)))) info))
  call-interactively(rudel-join-session nil nil)

None of these seem fatal, as I can eventually "join" a session, open documents, and all that, but man!

Oh, this is the latest version: 0.24 of Rudel or whatever it is in the repository.

Thanks, Jan!

[new]
I'd really like to be able to highlight other participants' <code>(point)</code> - is this supported in the Obby protocol? Has anybody else looked into this? As a quick hack, i'm looking to notify the user that changes have been made outside of their current window (view of the buffer) - to make it easier to see if someone is editing line 1 when you're looking at line 1024 for example

[new]
The obby protocol does not support highlighting point (or anything regarding the peer's status that does not involve text changes).

It is easy to add "unofficial" messages to the obby protocol implementation as long as only Rudel clients and a Rudel server are involved. However, this would obviously break interoperability with Gobby. As a short-term workaround, a protocol backend similar to obby could be made available for this case. This would allow developing the necessary user interface.

The long-term solution should probably be based on the infinote protocol (used by Gobby starting with version 0.5), which does support user status, cursor position and selection signaling. Rudel's infinote support is under development and not yet usable in production.

The alternate approach you suggest would also be nice as a protocol-independent feature. It should not be too hard to implement either. Protocol-independent tracking of user status is already available in a branch. Maybe you can visit the IRC channel to discuss this issue further?
--JanMoringen

[new]
I would like to use rudel with auctex (with inline preview) for collaborative LaTeX documents.  Unfortunately, this is too hard for most mathematicians (me for example) to install.  How can this be simplified?  With a script or package of some kind?  reply here or something.

[new]
Probably not the answer you are looking for, but with regard to installing Rudel, the procedure depends on your operating system, the Emacs version and desired install location. 

In case you are on a Debian GNU/Linux system (Ubuntu Linux should be equivalent in this case, I suppose), you could try to use the packages provided here: http://www.gergely.risko.hu/cedet/. I have not tried these myself, though.

Alternatively, for a recent version (23) of Emacs, downloading Rudel from http://sourceforge.net/projects/rudel/files/rudel/0.2-4/rudel-0.2-4.tar.gz/download and extracting it somewhere should work. The only additional work in this case is adding

 (load-file "/PATH/TO/EXTRACTED_RUDEL_FILES/rudel-loaddefs.el")
 (global-rudel-minor-mode 1)

to the .emacs init file. After the next restart of Emacs, a "Rudel" menu item should appear. 

In case you need additional assistance, try the #rudel IRC channel periodically. Sooner or later somebody who can help should be there. --JanMoringen

[new]
I am interested in automating rudel configuration, e.g. as an el-get recipe. The procedure to eval rudel-compile.el to produce rudel-loaddefs.el complicated automatic deployment. The following command worked for me:

    emacs -batch -l rudel-compile.el -eval "(eval-buffer)"

Eventually, it would be nice to have an easier method, e.g. a rudel-initialize function designed to be called from emacs init, tasked with creating or creating rudel-loadefs as needed.

== Contributed Code ==

=== Send Chat Messages (obby Protocol only) ===

Since this was requested once but is not suitable for Rudel itself, it's probably the best solution  to share it here:
{{{
(defun rudel-chat-send-message (text)
  (interactive
   (list (read-string "Text: ")))
  (let ((connection (oref rudel-current-session :connection)))
    (rudel-send connection "obby_message" text)))

(defun rudel-chat-send-current-line ()
  (interactive)
  (let ((end   (point))
	(start (save-excursion
		 (beginning-of-line)
		 (point))))
    (rudel-chat-send-message (buffer-substring start end))
    (delete-region start end)))

;; eval in *rudel-chat-log-buffer*:
(local-set-key (kbd "RET") #'rudel-chat-send-current-line)
}}}
